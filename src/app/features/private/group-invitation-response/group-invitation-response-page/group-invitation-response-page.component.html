<div class="invitation-container">
  @if (groupInvitation.isLoading()) {
    <nz-spin nzSize="large"></nz-spin>
  } @else if (groupInvitation.error()) {
    @switch (errorCode()) {
      @case (404) {
        <nz-result
          nzStatus="404"
          nzTitle="Invitation Not Found"
          nzSubTitle="The invitation link might be invalid or expired."
        >
          <div nz-result-extra>
            <button nz-button nzType="primary" routerLink="/">Go Home</button>
          </div>
        </nz-result>
      }
      @case (403) {
        <nz-result
          nzStatus="403"
          nzTitle="Forbidden"
          nzSubTitle="You do not have permission to view this invitation."
        >
          <div nz-result-extra>
            <button nz-button nzType="primary" routerLink="/app/dashboard">
              Go Home
            </button>
          </div>
        </nz-result>
      }
      @case (409) {
        <nz-result
          nzStatus="info"
          nzTitle="Already a Member"
          nzSubTitle="You are already a member of this group."
        >
          <div nz-result-extra>
            <button
              nz-button
              nzType="primary"
              [routerLink]="['/app/community/groups/', groupId()]"
            >
              Go to Group
            </button>
          </div>
        </nz-result>
      }
      @default {
        <nz-result
          nzStatus="500"
          nzTitle="Something Went Wrong"
          nzSubTitle="We couldn't load the invitation details. Please try again later."
        >
          <div nz-result-extra>
            <button
              nz-button
              nzType="primary"
              (click)="groupInvitation.reload()"
            >
              Try Again
            </button>
          </div>
        </nz-result>
      }
    }
  } @else if (groupInvitation.value(); as invitation) {
    @switch (groupInvitationStatus()) {
      @case ("sent") {
        <nz-card class="invitation-card">
          <div class="invitation-content">
            <div class="invitation-icon">
              <span
                nz-icon
                nzType="mail"
                nzTheme="twotone"
                [nzTwotoneColor]="'var(--third-color)'"
              ></span>
            </div>

            <h2 class="invitation-title">Group Invitation</h2>

            <div class="invitation-message">
              <p class="message-text">
                You have been invited to join group: <br />
                <strong>{{ invitation.groupName }}</strong>
              </p>
            </div>

            <div class="invitation-actions">
              <button
                nz-button
                nzType="primary"
                nzSize="large"
                nzBlock
                (click)="acceptInvitation()"
                [nzLoading]="processing()"
                [disabled]="processing()"
                class="accept-btn"
              >
                Accept Invitation
              </button>

              <button
                nz-button
                nzDanger
                nzSize="large"
                nzBlock
                (click)="rejectInvitation()"
                [nzLoading]="processing()"
                [disabled]="processing()"
                class="reject-btn"
              >
                Reject Invitation
              </button>
            </div>
          </div>
        </nz-card>
      }
      @case ("expired") {
        <nz-result
          nzStatus="warning"
          nzTitle="Invitation Expired"
          nzSubTitle="This invitation has expired and can no longer be accepted."
        >
          <div nz-result-extra>
            <button nz-button nzType="primary" routerLink="/app/dashboard">
              Go Home
            </button>
          </div>
        </nz-result>
      }
      @case ("accepted") {
        <nz-result
          nzStatus="success"
          nzIcon="success"
          nzTitle="Invitation Already Accepted"
          nzSubTitle="You have successfully joined the group."
        >
          <div nz-result-extra>
            <button
              nz-button
              nzType="primary"
              [routerLink]="['/app/community/groups/', groupId()]"
            >
              Go to Group
            </button>
          </div>
        </nz-result>
      }
      @case ("rejected") {
        <nz-result
          nzStatus="success"
          nzIcon="success"
          nzTitle="Invitation Already Rejected"
          nzSubTitle="You have already rejected this invitation."
        >
          <div nz-result-extra>
            <button
              nz-button
              nzType="primary"
              [routerLink]="['/app/community/groups/', groupId()]"
            >
              Go to Group
            </button>
          </div>
        </nz-result>
      }
      @case ("revoked") {
        <nz-result
          nzStatus="info"
          nzTitle="Invitation No Longer Valid"
          nzSubTitle="This invitation has been revoked by the group administrator."
        >
          <div nz-result-extra>
            <button nz-button nzType="primary" routerLink="/app/dashboard">
              Go Home
            </button>
          </div>
        </nz-result>
      }
    }
  }
</div>
