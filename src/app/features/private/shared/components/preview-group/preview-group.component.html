<div class="preview-container">
  <nz-spin [nzSpinning]="loading()" nzSize="large">
    <div class="two-column-layout">
      <div class="left-column">
        <app-group-info-card *ngIf="group()" [group]="group()!">
          <app-group-actions
            [group]="group()!"
            [mode]="mode()"
            (actionComplete)="onActionComplete()"
          ></app-group-actions>
        </app-group-info-card>

        <nz-card
          *ngIf="
            group() &&
            (mode() === GroupPreviewMode.MEMBER ||
              mode() === GroupPreviewMode.ADMIN)
          "
          class="section-card"
        >
          <app-ranking-list-peak
            [membersList]="membersList()"
            (viewFullRanking)="goToRankingPage()"
          >
          </app-ranking-list-peak>
        </nz-card>

        <nz-card
          *ngIf="group() && mode() === GroupPreviewMode.ADMIN"
          class="section-card"
        >
          <app-members-list-peak
            [membersList]="membersList()"
            [showManageButton]="true"
            (manageMembers)="goToManageGroupMembersPage()"
          >
          </app-members-list-peak>
        </nz-card>

        <nz-card
          *ngIf="group() && mode() === GroupPreviewMode.ADMIN"
          class="section-card"
        >
          <app-group-requests-list-peak
            [requestsList]="requestsList()"
            [showManageButton]="true"
            (manageRequests)="goToManageGroupRequestsPage()"
          >
          </app-group-requests-list-peak>
        </nz-card>
      </div>

      <div
        class="right-column"
        *ngIf="
          group() &&
          (mode() === GroupPreviewMode.MEMBER ||
            mode() === GroupPreviewMode.ADMIN)
        "
      >
        <div
          *ngIf="group() && mode() === GroupPreviewMode.ADMIN"
          class="admin-actions-bar"
        >
          <button
            nz-button
            nzType="default"
            nzSize="large"
            (click)="openEditModal()"
          >
            <span nz-icon nzType="edit"></span>
            Edit Group
          </button>

          <button nz-button nzDanger nzSize="large" (click)="confirmDelete()">
            <span nz-icon nzType="delete"></span>
            Delete Group
          </button>
        </div>
        <app-group-task-list
        [mode]="mode()"
        [groupMembersList]="membersList()"
        [group]="group()!"
        [groupId]="groupId()!"
        (refreshGroup)="onActionComplete()"
        >
        </app-group-task-list>
      </div>
    </div>

    <nz-card *ngIf="!group() && !loading()" class="error-card">
      <div class="error-content">
        <span nz-icon nzType="exclamation-circle" class="error-icon"></span>
        <h2>Group Not Found</h2>
        <p>The group with the given ID does not exist or has been deleted.</p>
      </div>
    </nz-card>
  </nz-spin>
  <app-edit-group-form
    [group]="group()!"
    [members]="membersList()"
    (groupUpdated)="onActionComplete()"
    ></app-edit-group-form>

</div>
